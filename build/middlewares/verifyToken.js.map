{"version":3,"sources":["../../src/middlewares/verifyToken.js"],"names":["jwt","require","config","verifyToken","req","res","next","token","headers","authorization","status","send","auth","message","verify","secret","err","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,cAAD,CAAtB;;AAEA,SAASE,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACjC,MAAIC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAxB;;AACA,MAAI,CAACF,KAAL,EAAY;AACR,WAAOF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,MAAAA,IAAI,EAAE,KADkB;AAExBC,MAAAA,OAAO,EAAE;AAFe,KAArB,CAAP;AAIH;;AAEDb,EAAAA,GAAG,CAACc,MAAJ,CAAWP,KAAX,EAAkBL,MAAM,CAACF,GAAP,CAAWe,MAA7B,EAAqC,UAACC,GAAD,EAAS;AAC1C,QAAIA,GAAJ,EAAS;AACL,aAAOX,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,QAAAA,IAAI,EAAE,KADkB;AAExBC,QAAAA,OAAO,EAAE;AAFe,OAArB,CAAP;AAIH;;AACDP,IAAAA,IAAI;AACP,GARD;AASH;;AAEDW,MAAM,CAACC,OAAP,GAAiBf,WAAjB","sourcesContent":["const jwt = require('jsonwebtoken');\r\nconst config = require('./../configs');\r\n\r\nfunction verifyToken(req, res, next) {\r\n    let token = req.headers.authorization;\r\n    if (!token) {\r\n        return res.status(403).send({\r\n            auth: false,\r\n            message: \"missing token, please login\"\r\n        });\r\n    }\r\n\r\n    jwt.verify(token, config.jwt.secret, (err) => {\r\n        if (err) {\r\n            return res.status(401).send({\r\n                auth: false,\r\n                message: \"no authorized\"\r\n            })\r\n        }\r\n        next();\r\n    });\r\n}\r\n\r\nmodule.exports = verifyToken;"],"file":"verifyToken.js"}